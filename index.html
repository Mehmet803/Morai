<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>MÃ˜Râ€¢AI v5.60 ULTIMATE</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --bg-light: #ffffff;
      --text-light: #111111;
      --bot-light: #e5e7eb;
      --border-light: #d1d5db;

      --bg-dark: #0f172a;
      --text-dark: #f1f5f9;
      --bot-dark: #1e293b;
      --border-dark: #334155;

      --user-bubble: linear-gradient(135deg,#6366f1,#a855f7);
      --accent: #7c3aed;
    }

    * { box-sizing:border-box; }

    body {
      margin:0;
      height:100vh;
      font-family:system-ui,sans-serif;
      display:flex;
      justify-content:center;
      align-items:center;
    }

    .app {
      width:100%;
      max-width:540px;
      height:100vh;
      display:flex;
      flex-direction:column;
      border-left:1px solid var(--border);
      border-right:1px solid var(--border);
    }

    header {
      padding:12px;
      font-size:16px;
      font-weight:bold;
      display:flex;
      justify-content:space-between;
      align-items:center;
      border-bottom:1px solid var(--border);
    }

    #settingsBtn { cursor:pointer; font-size:18px; }

    #settingsMenu {
      display:none;
      position:absolute;
      right:10px;
      top:50px;
      background:var(--bg);
      border:1px solid var(--border);
      border-radius:12px;
      padding:10px;
      width:220px;
      z-index:10;
    }

    #settingsMenu label { display:block; margin:6px 0; font-size:14px; }

    .chat {
      flex:1;
      overflow-y:auto;
      padding:12px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .msg {
      max-width:75%;
      padding:8px 12px;
      border-radius:12px;
      font-size:14px;
      white-space:pre-line;
    }

    .user {
      margin-left:auto;
      background:var(--user-bubble);
      color:white;
    }
    .bot {
      background:var(--bot);
      color:var(--text);
      border:1px solid var(--border);
    }

    .inputBar {
      padding:10px;
      display:flex;
      gap:6px;
      border-top:1px solid var(--border);
    }

    #input {
      flex:1;
      padding:10px;
      border:1px solid var(--border);
      border-radius:20px;
    }

    #fileInput { display:none; }
    #sendBtn, #fileBtn, #micBtn {
      width:38px;height:38px;
      border-radius:50%;
      border:none;
      background:var(--accent);
      color:white;
      cursor:pointer;
      font-size:18px;
    }

    .typing {
      font-size:12px;
      opacity:0.7;
    }
  </style>
</head>

<body>
  <div class="app">
    <header>
      <span>MÃ˜Râ€¢AI v5.60</span>
      <span id="settingsBtn">âš™ï¸</span>

      <div id="settingsMenu">
        <label><input type="checkbox" id="darkMode"/> KaranlÄ±k modu aÃ§</label>
        <label><input type="checkbox" id="historySave" checked/> Sohbet kaydet</label>
      </div>
    </header>

    <div class="chat" id="chat"></div>

    <div class="inputBar">
      <input type="file" id="fileInput" accept="image/*"/>
      <button id="fileBtn">ğŸ“</button>
      <input id="input" placeholder="Bir ÅŸey yaz reisâ€¦"/>
      <button id="micBtn">ğŸ¤</button>
      <button id="sendBtn">â¡ï¸</button>
    </div>
  </div>

<script>
let currentPersonality="street"; // VarsayÄ±lan: Reis modu

function setTheme(){
  const dark=darkMode.checked;
  document.documentElement.style.setProperty("--bg",dark?"var(--bg-dark)":"var(--bg-light)");
  document.documentElement.style.setProperty("--text",dark?"var(--text-dark)":"var(--text-light)");
  document.documentElement.style.setProperty("--bot",dark?"var(--bot-dark)":"var(--bot-light)");
  document.documentElement.style.setProperty("--border",dark?"var(--border-dark)":"var(--border-light)");
}
darkMode.onchange=setTheme;
setTheme();

settingsBtn.onclick=()=>{
  settingsMenu.style.display=settingsMenu.style.display==="block"?"none":"block";
};

function time(){
  const d=new Date();
  return `${d.getHours().toString().padStart(2,"0")}:${d.getMinutes().toString().padStart(2,"0")}`;
}

function addMsg({text="",user=false,img=null}){
  const el=document.createElement("div");
  el.className="msg "+(user?"user":"bot");
  if(img){
    const i=document.createElement("img");
    i.src=img;
    i.style.maxWidth="220px";
    i.style.borderRadius="10px";
    i.style.display="block";
    i.style.marginBottom="5px";
    el.appendChild(i);
  }
  el.appendChild(document.createTextNode(text));
  chat.appendChild(el);
  chat.scrollTop=chat.scrollHeight;
}

function botTyping(s){
  let t=document.getElementById("typing");
  if(s){
    if(!t){
      t=document.createElement("div");
      t.id="typing";
      t.className="typing";
      t.textContent="MÃ˜Râ€¢AI yazÄ±yorâ€¦";
      chat.appendChild(t);
    }
  } else{ if(t) t.remove(); }
}

function commands(msg){
  if(msg==="/yardÄ±m"){
    addMsg({text:"Komutlar:\n/yardÄ±m\n/temizle\n/versiyon",user:false});
    return true;
  }
  if(msg==="/temizle"){
    chat.innerHTML="";
    welcome();
    return true;
  }
  if(msg==="/versyon"){
    addMsg({text:"MÃ˜Râ€¢AI v5.60 ULTIMATE ğŸ”¥",user:false});
    return true;
  }
  return false;
}

function detectImage(m){
  m=m.toLowerCase();
  if(m.includes("resim")||m.includes("foto")||m.includes("gÃ¶rsel")){
    let t=m.replace("bana","").replace("resim","").replace("foto","").replace("gÃ¶rsel","").trim();
    return t||"manzara";
  }
  return null;
}

function showImage(t){
  addMsg({text:`"${t}" gÃ¶rseli:`,user:false});
  addMsg({img:`https://source.unsplash.com/400x300/?${encodeURIComponent(t)}`,user:false});
}

async function wiki(q){
  q=q.toLowerCase().replace(" nedir","").replace(" kimdir","").replace("?","").trim();
  try{
    const r=await fetch("https://tr.wikipedia.org/api/rest_v1/page/summary/"+encodeURIComponent(q));
    if(!r.ok) return null;
    const d=await r.json();
    return d.extract||null;
  }catch{return null;}
}

async function botAnswer(msg){
  if(commands(msg)) return;

  const img=detectImage(msg);
  if(img){
    botTyping(true);
    await new Promise(r=>setTimeout(r,600));
    botTyping(false);
    showImage(img);
    return;
  }

  botTyping(true);
  const info=await wiki(msg);
  botTyping(false);

  if(info){
    let txt;
    switch(currentPersonality){
      case "street": txt=`Reis ÅŸÃ¶yle diyim ğŸ‘‡\n${info}`; break;
      case "spiritual": txt=`ğŸ•Š Manevi bilgi:\n${info}`; break;
      case "scientific": txt=`ğŸ“š KaynaklÄ± bilgi:\n${info}`; break;
      default: txt=info;
    }
    addMsg({text:txt,user:false});
  } else {
    addMsg({text:"Kaynak bulamadÄ±m reis ğŸ˜…",user:false});
  }
}

sendBtn.onclick=send;
input.onkeydown=e=>{if(e.key==="Enter") send();}
function send(){
  const v=input.value.trim();
  if(!v) return;
  addMsg({text:v,user:true});
  input.value="";
  botAnswer(v);
}

fileBtn.onclick=()=>fileInput.click();
fileInput.onchange=()=>{
  const file=fileInput.files[0];
  if(!file)return;
  const u=URL.createObjectURL(file);
  addMsg({img:u,user:true});
  setTimeout(()=>addMsg({text:"FotoÄŸraf geldi reis ğŸ“·",user:false}),400);
};

function welcome(){
  addMsg({text:
`Selam reis ğŸ‘‘
Ben **MÃ˜Râ€¢AI v5.60**

âœ” KaranlÄ±k/AÃ§Ä±k tema
âœ” Reis modu aktif
âœ” GÃ¶rsel iste: "aslan resmi"
âœ” Wikipedia'dan bilgi

Komut: /yardÄ±m /temizle /versyon

ğŸ”¥ HazÄ±rsan baÅŸlayalÄ±m!`
  ,user:false});
}
welcome();
</script>
</body>
</html>
